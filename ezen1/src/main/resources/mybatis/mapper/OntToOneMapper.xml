<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.ezen.dao.IonetooneDAO">

	<!-- MALL_oneToOne에서 등록된 모든 정보를 가져옴. -->	
	<select id="getOneToOneList" resultType="com.ezen.dto.OneToOne">
		SELECT * FROM MALL_ONETOONE
	</select>
	
	<!-- oneToone_idx를 받아서 MALL_onetoone에서 값이 null인 onetoone_reply에 입력받은 내용을 넣어줌. oneToone_isreply값을 true로 변경 -->
	<update id="updateQnaAnswerByReplyAndContent">
		UPDATE MALL_ONETOONE SET onetoone_reply= #{onetoone_reply}, oneToone_isreply = oneToone_isreply + #{onetoone_reply} WHERE oneToone_idx = #{oneToone_idx}
	</update>
	
	<!-- Mall_ONETOONE에서 해당 user_idx를 가진 data를 가져옴. -->
	<select id="getOnetoOneByUserIdx" resultType="com.ezen.dto.OneToOne">
		SELECT * FROM MALL_ONETOONE WHERE user_idx = #{user_idx}
	</select>
	
	<!-- OneToOne을 받아 mall_onetoone에 insert -->
	<insert id="insertOneToOne" parameterType="com.ezen.dto.OneToOne">
		INSERT INTO MALL_ONETOONE (onetoone_idx, user_idx, onetoone_cat, onetoone_title, onetoone_contents, onetoone_date, onetoone_isreplied, onetoone_reply, onetoone_reply_date)
			VALUES (mall_onetoone_seq.nextval, #{user_idx}, #{onetoone_cat}, #{onetoone_title}, #{onetoone_contents}, #{onetoone_date}, #{onetoone_isreplied}, #{onetoone_reply}, #{onetoone_reply_date})
	</insert>

</mapper>